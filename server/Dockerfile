FROM node:18

WORKDIR /server

COPY ./package*.json ./
RUN npm install
COPY . .

EXPOSE 3002

ARG SERVER_PORT
ENV SERVER_PORT=$SERVER_PORT
ARG DATABASE_HOST
ENV DATABASE_HOST=$DATABASE_HOST
ARG DATABASE_PORT
ENV DATABASE_PORT=$DATABASE_PORT
ARG DATABASE_NAME
ENV DATABASE_NAME=$DATABASE_NAME
ARG DATABASE_USERNAME
ENV DATABASE_USERNAME=$DATABASE_USERNAME
ARG DATABASE_PASSWORD
ENV DATABASE_PASSWORD=$DATABASE_PASSWORD

ARG CLIENT_ORIGIN
ENV CLIENT_ORIGIN=$CLIENT_ORIGIN
ARG JWT_KEY
ENV JWT_KEY=$JWT_KEY
ARG COOKIE_KEY
ENV COOKIE_KEY=$COOKIE_KEY

CMD [ "npm", "run", "start" ]